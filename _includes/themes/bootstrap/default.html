<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>{{ page.title }}</title>
    {% if page.description %}<meta name="description" content="{{ page.description }}">{% endif %}
    <meta name="author" content="{{ site.author.name }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="{{ ASSET_PATH }}/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  
    <!--[if lt IE 9]>
      <script src="{{ ASSET_PATH }}/resources/respond/Respond.min.js"></script>
    <![endif]-->

    <link href="{{ BASE_PATH }}{{ site.JB.atom_path }}" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="{{ BASE_PATH }}{{ site.JB.rss_path }}" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <nav class="navbar navbar-default" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="{{ HOME_PATH }}">{{ site.title }}</a>
        </div>

        <div class="collapse navbar-collapse navbar-ex1-collapse">
          <ul class="nav navbar-nav">
          	<li><a href="http://www.faacets.com">Faacets main site</a></li>
          <!--
            {% assign pages_list = site.pages %}
            {% assign group = 'navigation' %}
            {% include JB/pages_list %}
            -->
          </ul>
        </div>
      </div>
    </nav>
    

    
    <div class="container">
      <div class="col-sm-9">
        {{ content }}
      </div>

      <div class="col-sm-3" style="padding-top : 4em;">
        <div class="well">
          <!-- We add a menu on the left -->
          <!-- The menu will display all pages which have been given a variable 'parent' which
               relates it somehow to the 'main' page. The menu follows the tree structure defined by
               the pairs of variables 'title' and 'parent': a page appears as submenu of another one
               iff its parent name is the same as the title of the first page. Pages with no parents
               must be given the parent name 'main'. -->
          <h3> Table of Contents </h3>
          {% assign pages = site.pages | sort:"url"  %}
          <!-- We put in the menu:
                1. All pages of the first level 
                2. All the pages that are in the same sub-section -->
          <ul class="nav nav-pills nav-stacked">
          {% for p in pages %}
            {% if p.path == "index.md" %}
              {% for x in p.children %}
                  <!-- We identified an element of the menu -->
                  <!-- let's find the corresponding file -->
                  <!-- First we define a new variable with the full name of the file -->
                  {% for p2 in pages %}
                    {% if p2.path == {{x}} %}
                      <!-- We found the corresponding page, it is p2 -->
                      <!-- We can produce the corresponding menu element -->
                      <li role="presentation" {% if p2.url == page.url %}class="active"{% endif %}><a href={{p2.url}}>{{p2.title}}</a></li>
                      <!-- Now if the current page happens to be one of its children, we display all the children as well -->
                      {% if p2.url == page.url %}
                        {% assign inThisSubfolder = 1 %}
                      {% else %}
                        {% assign inThisSubfolder = 0 %}
                      {% endif %}
                      {% for z in p2.children %}
                        <!-- We identified the pages corresponding to each of the children -->
                        {% for p3 in pages %}
                          {% if p3.path == {{z}} %}
                            <!-- Now p3 is one of the children of p2, we check whether it corresponds to the current page -->
                            {% if p3.url == page.url %}
                              {% assign inThisSubfolder = 1 %}
                            {% endif %}
                          {% endif %}
                        {% endfor %}
                      {% endfor %}
                      <!-- If we are in this folder, we display the second layer of the menu -->
                      {% if inThisSubfolder == 1 %}
                        <ul class="nav.nav nav-pills nav-stacked">
                        {% for z in p2.children %}
                          <!-- We identified the pages corresponding to each of the children -->
                          {% for p3 in pages %}
                            {% if p3.path == {{z}} %}
                              <!-- Now p3 is one of the children of p2, we add it to the menu -->
                              <li role="presentation" {% if p3.url == page.url %}class="active"{% endif %}><a href={{p3.url}}>{{p3.title}}</a></li>
                            {% endif %}
                          {% endfor %}
                        {% endfor %}
                        </ul>
                      {% endif %}
                    {% endif %}
                  {% endfor %}
              {% endfor %}
            {% endif %}
          {% endfor %}
          </ul>
        </div>
      </div>

      <div class="col-sm-12">
        <hr>
        
        <footer>
          <p>
            &copy; {{ site.time | date: '%Y' }} {{ site.author.name }}
            <span class="pull-right text-muted">
              powered by
              <a href="http://dbtek.github.io/jekyll-bootstrap-3" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll-Bootstrap-3</a>
              and <a href="http://getbootstrap.com" target="_blank">Twitter Bootstrap 3.0.3</a>
            </span>
          </p>
        </footer>
      </div>
    </div>

    {% include JB/analytics %}
    <script src="{{ ASSET_PATH }}/resources/jquery/jquery.min.js"></script>
    <script src="{{ ASSET_PATH }}/resources/bootstrap/js/bootstrap.min.js"></script>
  </body>
  
</html>
